import { RolesBuilder } from 'nest-access-control';
import { Role } from './enums/roles.enum';

export const RBAC_POLICY: RolesBuilder = new RolesBuilder();

RBAC_POLICY.grant(Role.USER)
  .readOwn(['products', 'ventures', 'notifications'])
  .readAny(['opportunities'])
  .updateOwn(['ventures', 'comments', 'products', 'mentors', 'addCV', 'notifications'])
  .deleteOwn(['ventures', 'comments', 'products', 'mentors'])
  .grant(Role.MENTOR)
  .extend(Role.USER)
  .grant(Role.STAFF)
  .readAny([
    'stats',
    'users',
    'phases',
    'expertises',
    'programs',
    'mentors',
    'subprograms',
    'roles',
    'comments',
    'events',
    'eventCategories',
    'programCategories',
    'projects',
    'projectCategories',
    'blogs',
    'ventures',
    'tags',
    'opportunities',
    'exportUsersCSV',
    'notifications'
  ])
  .createAny([
    'indicators',
    'users',
    'phases',
    'expertises',
    'programs',
    'comments',
    'events',
    'roles',
    'tags',
    'subprograms',
    'phases',
    'eventCategories',
    'programCategories',
    'projectCategories',
    'projects',
    'blogs',
    'opportunities',
    'notifications'
  ])
  .updateAny([
    'indicators',
    'users',
    'phases',
    'programs',
    'subprograms',
    'events',
    'comments',
    'eventCategories',
    'programCategories',
    'projectCategories',
    'projects',
    'roles',
    'blogs',
    'tags',
    'ventures',
    'publishVenture',
    'mentorApplications',
    'expertises',
    'opportunities'
  ])
  .deleteAny([
    'indicators',
    'users',
    'phases',
    'programs',
    'subprograms',
    'events',
    'roles',
    'comments',
    'tags',
    'eventCategories',
    'programCategories',
    'projectCategories',
    'projects',
    'blogs',
    'ventures',
    'galleries',
    'mentors',
    'expertises',
    'opportunities'
  ])
  .grant(Role.ADMIN)
  .extend(Role.STAFF);
